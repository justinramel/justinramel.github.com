
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>just ram</title>
  <meta name="author" content="Justin Ramel">

  
  <meta name="description" content="I can never remember these so thought it best to write them down. Start with the settings from: http://codebetter.com/blogs/aaron.jensen/archive/2008 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://justinramel.com/page/5">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="just ram" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-35853047-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">just ram</a></h1>
  
    <h2>stuff I should remember</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:justinramel.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/06/10/resharper-format-settings/">Resharper format settings</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-10T18:15:59+01:00" pubdate data-updated="true">Jun 10<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I can never remember these so thought it best to write them down. Start with the settings from:</p>

<p><a href="http://codebetter.com/blogs/aaron.jensen/archive/2008/10/19/getting-resharper-and-vs-to-play-nice-with-mspec.aspx">http://codebetter.com/blogs/aaron.jensen/archive/2008/10/19/getting-resharper-and-vs-to-play-nice-with-mspec.aspx</a></p>

<p>Plus a few extras…</p>

<p>Go to menu Resharper –&gt; Options –&gt; Languages –&gt; C# –&gt; Formatting Style</p>

<ul>
  <li>
    <p>Braces Layout –&gt; All set to (BSD style)</p>
  </li>
  <li>
    <p>Braces Layout –&gt; Empty braces formatting = Together on the same line<a href="http://justinram.files.wordpress.com/2009/06/image6.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb6.png" alt="image" /></a></p>
  </li>
  <li>
    <p>Blank lines – I don’t like a lot of blank lines so I set mostly to 1/0<a href="http://justinram.files.wordpress.com/2009/06/image13.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb13.png" alt="image" /></a></p>
  </li>
  <li></li>
</ul>

<p>Other –&gt; Align Multiline Constructs – Call arguments = Off</p>

<ul>
  <li></li>
</ul>

<p>Other –&gt; Align Multiline Constructs – Expression = Off<a href="http://justinram.files.wordpress.com/2009/06/image14.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb14.png" alt="image" /></a></p>

<ul>
  <li></li>
</ul>

<p>Other –&gt; Other – Indent array, object and collection initializer block = Off<a href="http://justinram.files.wordpress.com/2009/06/image9.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb9.png" alt="image" /></a></p>

<h2 id="regions">Regions</h2>

<p>Stop Resharper adding regions to interface implementations and nested classes:</p>

<p>Go to menu: Resharper –&gt; Options –&gt; Languages –&gt; C# –&gt; Type Members Layout</p>

<p>Un-tick Use Default Patterns and you get a text area full of xml. Scroll to the bottom and delete the section:</p>

<group>     
<implementsinterface immediate="true" region="${ImplementsInterface} Members" />      
</group>

<p><a href="http://justinram.files.wordpress.com/2009/06/image10.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb10.png" alt="image" /></a></p>

<p>Also delete the section:</p>

<group>     
<name region="Nested type: ${Name}" />      
</group>

<p><a href="http://justinram.files.wordpress.com/2009/06/image11.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb11.png" alt="image" /></a></p>

<p>Finally click Ok.</p>

<h2 id="code-cleanup">Code Cleanup</h2>

<p>Go to menu Resharper –&gt; Options –&gt; Tools –&gt; Code Cleanup</p>

<p>Add a new profile with the following settings:</p>

<p><a href="http://justinram.files.wordpress.com/2009/06/image12.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb12.png" alt="image" /></a></p>

<p>I didn’t realise I had fiddled with the default settings so much no wonder I can never remember them.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/06/08/setup-asp-net-mvc-with-spark-view-engine-in-5-minutes-or-less/">Setup ASP.NET MVC with Spark View Engine in 5 minutes or less</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-08T15:33:21+01:00" pubdate data-updated="true">Jun 8<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Setup folder structure:</p>

<p><a href="http://justinram.files.wordpress.com/2009/06/image.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb.png" alt="image" /></a></p>

<p>Download and put the <a href="http://www.asp.net/mvc/download/">asp.net mvc</a> dll’s in mvc folder and <a href="http://sparkviewengine.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=27109">spark</a> dll’s in spark folder. </p>

<p>Create a new asp.net application not a <strong>mvc</strong> application just a standard asp.net application. This means you will not get the mvc helpers for creating controllers and views but that’s not a massive loss and has the advantage that you don’t need the asp.net mvc installed if you open the solution on another machine.</p>

<p><a href="http://justinram.files.wordpress.com/2009/06/image1.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb1.png" alt="add new project" /></a>Change content of Default.aspx to: <!-- Placeholder do not delete! --></p>

<p>The default.aspx placeholder is required to allow the asp.net routing to work. </p>

<p>Delete the code behind files for Default.aspx (Default.aspx.cs, Default.aspx.designer.cs) they are not needed.</p>

<p>Add references to the Spark.dll and Spark.Web.Mvc.dll located in the libs folder.</p>

<p><a href="http://justinram.files.wordpress.com/2009/06/vs_add_ref.png"><img src="http://justinram.files.wordpress.com/2009/06/vs_add_ref_thumb.png" alt="vs_add_ref" /></a></p>

<p>Add references to asp.net mvc System.Web.Routing.dll, System.Web.Abstractions.dll, System.Web.Mvc.dll</p>

<p><a href="http://justinram.files.wordpress.com/2009/06/image2.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb2.png" alt="image" /></a></p>

<p>Add spark to the web.config:</p>

<p>&lt;/sectionGroup&gt;    <br />
&lt;section name=&#8221;spark&#8221; type=&#8221;Spark.Configuration.SparkSectionHandler, Spark&#8221;/&gt;     <br />
&lt;/configSections&gt;</p>

<spark>      
<compilation debug="true" />       
</spark>

<p>Debug true shows compilation errors when rendering views.</p>

<p>Add routing to httpModules section of web.config:</p>

<add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />

<p>Add a application.cs which creates the routes and registers the spark view engine:</p>

<p>using System.Collections.Generic;    <br />
using System.Web.Mvc;     <br />
using System.Web.Routing;     <br />
using Spark.Web.Mvc; </p>

<p>namespace Web    <br />
{     <br />
public class Application     <br />
{     <br />
public void RegisterRoutes(IList<routebase> routes)       
{       
routes.Add(new Route(       
&#8220;{controller}/{action}/{id}&#8221;,       
new RouteValueDictionary(new {controller = &#8220;home&#8221;, action = &#8220;index&#8221;, id = &#8220;&#8221;}),       
new MvcRouteHandler()));       
} </routebase></p>

<p>public void RegisterViewEngine(IList<iviewengine> engines)      
{       
SparkEngineStarter.RegisterViewEngine(engines);       
}       
}       
}</iviewengine></p>

<p>Add a global.asax with the following code behind.</p>

<p><a href="http://justinram.files.wordpress.com/2009/06/image3.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb3.png" alt="image" /></a></p>

<p>using System;    <br />
using System.Web;     <br />
using System.Web.Mvc;     <br />
using System.Web.Routing; </p>

<p>namespace Web    <br />
{     <br />
public class Global : HttpApplication     <br />
{     <br />
protected void Application_Start(object sender, EventArgs e)     <br />
{     <br />
var app = new Application();     <br />
app.RegisterRoutes(RouteTable.Routes);     <br />
app.RegisterViewEngine(ViewEngines.Engines);     <br />
} </p>

<p>protected void Application_BeginRequest(object sender, EventArgs e)    <br />
{     <br />
string path = Request.AppRelativeCurrentExecutionFilePath;     <br />
if (string.Equals(path, “~/default.aspx”, StringComparison.InvariantCultureIgnoreCase) ||     <br />
string.Equals(path, “~/”))     <br />
{     <br />
Context.RewritePath(“~/Home”);     <br />
}     <br />
}     <br />
}     <br />
}</p>

<p>Create content, controllers and view folders in the root of the asp.net project:</p>

<p><a href="http://justinram.files.wordpress.com/2009/06/image4.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb4.png" alt="image" /></a></p>

<p>Create a shared folder in the views folder with a _global.spark file this will be used to share come code with all views.</p>

<use namespace="System.Collections.Generic" />

<use namespace="System.Web.Mvc.Html" />

<p>Create a layouts folder in the views folder with a file called application.spark which will be used for the layout of the application very much like a master page.</p>

<p>&lt;!DOCTYPE html PUBLIC “-//W3C//DTD XHTML 1.0 Transitional//EN” “<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd”</a>&gt;     <br />
&lt;html xmlns=”<a href="http://www.w3.org/1999/xhtml&quot;">http://www.w3.org/1999/xhtml”</a>&gt;       </p>

<head>       
<title>Sample</title>       
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />       
</head>
<body>       
<h1>Header</h1>       
** <use content="view" />        
** <h1>Footer</h1>       
</body>
<p>&lt;/html&gt;</p>

<p>The use content view tag highlighted above is replaced by the current view returned by asp.net mvc.</p>

<p>Add a HomeController.cs under the controllers folder with the following content:</p>

<p>using System.Web.Mvc; </p>

<p>namespace Web.controllers    <br />
{     <br />
public class HomeController : Controller     <br />
{     <br />
public ActionResult Index()     <br />
{     <br />
return View();     <br />
}     <br />
}     <br />
}</p>

<p>Under the views folder create a home\index.spark with the following content:</p>

<p>Hello spark.</p>

<p>Run the project and you should get:</p>

<p><a href="http://justinram.files.wordpress.com/2009/06/image5.png"><img src="http://justinram.files.wordpress.com/2009/06/image_thumb5.png" alt="image" /></a></p>

<p>You can download this sample solution <a href="http://fppuvw.bay.livefilestore.com/y1puB8Efa8gk4G6CzMEi40m1JxymO-5kxvTnYWbZ3uh1YZD71y8xOd58vSLWuNpPG06X9y7MgTOntrkvH82-jAqoMWnN9ranxJ6/sparksetup.zip?download">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/06/04/howto-add-svnexternals-in-windows-using-tortoisesvn/">HOWTO: Add svn:externals in windows using tortoisesvn</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-04T01:00:25+01:00" pubdate data-updated="true">Jun 4<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have a few projects in subversion using the same set of third party tools nant, bdd, mbunit etc. I’ve read its a good idea to put the tools into their own repository and include them in the other projects using an svn:external. The advantage this gives you is any changes you make to the external repository can be updated easily across all projects. Any hoose this is who to do it. </p>

<ol>
  <li>
    <p>Go to the root of the folder you want to add the externals too. </p>
  </li>
  <li>
    <p>Right click on the root folder of the project you want to add the external repository to and select _T_ortoiseSVN –&gt; _P_roperties.<a href="http://justinram.files.wordpress.com/2009/06/tortoise_settings3.png"><img src="http://justinram.files.wordpress.com/2009/06/tortoise_settings3_thumb.png" alt="tortoise_settings[3]" /></a> <strong>Note:</strong> This folder has to be a checked out subversion repository or you’ll not get the context menu!</p>
  </li>
  <li>
    <p>You will now see the subversion properties dialog.<a href="http://justinram.files.wordpress.com/2009/06/tortoise_properties1.png"><img src="http://justinram.files.wordpress.com/2009/06/tortoise_properties1_thumb.png" alt="tortoise_properties[1]" /></a></p>
  </li>
  <li>
    <p>Click the _N_ew.. button. You will now see the Add properties dialog.<a href="http://justinram.files.wordpress.com/2009/06/tortoise_add_properties1.png"><img src="http://justinram.files.wordpress.com/2009/06/tortoise_add_properties1_thumb.png" alt="tortoise_add_properties[1]" /></a></p>
  </li>
  <li>
    <p>Select svn:externals from the property name drop down list. </p>
  </li>
  <li>
    <p>Enter the name you want to give to the external folder followed by the path to your tools repository in property value text area.      <br />
In the example above: tools svn://server/tools/trunk       <br />
<strong>Note:</strong> You can add more external repositories by simply adding more lines to the property value text area. </p>
  </li>
  <li>
    <p>Click Ok to add the property will now be listed in the properties dialog.<a href="http://justinram.files.wordpress.com/2009/06/tortoise_properties21.png"><img src="http://justinram.files.wordpress.com/2009/06/tortoise_properties21_thumb.png" alt="tortoise_properties2[1]" /></a></p>
  </li>
  <li>
    <p>Right click on the root folder and select SVN Update from the menu. Subversion will now pull down the files from the external repository and your done. </p>
  </li>
</ol>

<p>Once you check this change in other people checking out from the repository will automatically get the externals folder. Also any changes to the external repository will be updated in this repository on any update. So in this case if I add a new tool or update one of the tools all repositories using this external repository will get the changes on their next update. </p>

<h3 id="gotchas">Gotchas</h3>

<ul>
  <li>Don’t forget to give the folder name before the repository address and not just the repository address or you will get an error along the lines of: Error parsing svn:externals property on …<img src="http://justinram.files.wordpress.com/2009/06/tortoise_error1_thumb.png" alt="tortoise_error[1]" /></li>
</ul>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/05/20/howto-download-and-run-microsoft-report-builder-1-0/">HOWTO: Download and run Microsoft Report Builder 1.0</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-20T17:58:51+01:00" pubdate data-updated="true">May 20<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Assuming you have an SQL Server 2005 running reporting services you can run Report builder as a ClickOnce app using the following url:</p>

<p>http://<_servername_>/reportserver/reportbuilder/reportbuilder.application</_servername_></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/04/30/developwithpassionbdd-notes/">developwithpassion.bdd - notes</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-30T19:29:37+01:00" pubdate data-updated="true">Apr 30<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A few notes I’ve compiled while starting to play with <a href="http://blog.jpboodhoo.com/">JP Boodhoo’s</a> BDD framework (<a href="http://github.com/developwithpassion">http://github.com/developwithpassion</a>). At first sight the syntax looks quite alien but try it for a while you eyes soon adjust. </p>

<h2 id="jp-blog-posts">JP blog posts</h2>

<ul>
  <li>
    <p><a href="http://blog.jpboodhoo.com/HowIrsquomCurrentlyWritingMyBDDStyleTestsNdashPart1.aspx">How I’m Currently Writing My BDD Style Tests – Part 1</a></p>
  </li>
  <li>
    <p><a href="http://blog.jpboodhoo.com/HowIrsquomCurrentlyWritingMyBDDStyleTestsNdashPart2.aspx">How I’m Currently Writing My BDD Style Tests – Part 2</a></p>
  </li>
  <li>
    <p><a href="http://blog.jpboodhoo.com/TestExamplesWithMBUnitAndJpboodhoobdd.aspx">Test examples with MBUnit and jpboodhoo.bdd</a></p>
  </li>
  <li>
    <p><a href="http://blog.jpboodhoo.com/SlightAdditionToJpboodhoobdd.aspx">Slight addition to jpboodhoo.bdd</a></p>
  </li>
  <li>
    <p><a href="http://blog.jpboodhoo.com/UsingJpboodhoobddWithTestDrivenNet.aspx">Using jpboodhoo.bdd with TestDriven.Net</a></p>
  </li>
  <li>
    <p><a href="http://blog.jpboodhoo.com/MoreNewConventionsForHowIOrganizeMyTests.aspx">More new conventions for how I organize my tests!!</a></p>
  </li>
</ul>

<h2 id="base-classes">Base classes</h2>

<ul>
  <li>
    <p>observations_for_a_static_sut – For testing a static class or a quick inline test</p>
  </li>
  <li>
    <p>observations_for_a_sut_with_a_contract – For testing against the interface of a class </p>

    <ul>
      <li>
        <p>sut is automatically created </p>
      </li>
      <li>
        <p>No more broken test when you add a new dependency to a class! YAY</p>
      </li>
      <li>
        <p>Automatic creation of sut can be over ridden</p>
      </li>
    </ul>
  </li>
  <li>
    <p>observations_for_a_sut_without_a_contract – For testing against a concrete class</p>
  </li>
</ul>

<h2 id="delegate-call-order">Delegate call order</h2>

<ul>
  <li>
    <p>context</p>

    <ul>
      <li>
        <p>Can define a context block in the concerns base class which will be run before a context block in the inheriting class</p>
      </li>
      <li>
        <p>Can call method provide_a_basic_sut_constructor_argument</p>
      </li>
    </ul>
  </li>
  <li>
    <p>after_sut_has_been_initialized</p>
  </li>
  <li>
    <p>because</p>
  </li>
  <li>
    <p>it</p>
  </li>
  <li>
    <p>after_each_observation</p>
  </li>
</ul>

<h2 id="exceptions">Exceptions</h2>

<p>When you want to <strike>test</strike> spec? for an exception use the doing method:</p>

<blockquote>

  <p>because b = () =&gt;      <br />
doing(() =&gt; sut.MethodWhichThrows()); </p>

  <p>it should_throw_exception = () =&gt;     <br />
exception_thrown_by_the_sut.Message.should_contain(“MY EXCEPTION”); </p>
</blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/01/23/castle-activerecord-exception-the-proxyfactoryfactory-was-not-configured/">Castle ActiveRecord – Exception : The ProxyFactoryFactory was not configured</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-01-23T16:38:12+00:00" pubdate data-updated="true">Jan 23<span>rd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’ve just updated to the latest version of the Castle stack and got hit with this exception:</p>

<pre><code>The ProxyFactoryFactory was not configured.
Initialize 'proxyfactory.factory_class' property of the session-factory configuration section with one of the available NHibernate.ByteCode providers.
Example:
NHibernate.ByteCode.LinFu.ProxyFactoryFactory, NHibernate.ByteCode.LinFu
Example:
NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle
</code></pre>

<p>Turns out the NHibernate config has changed and as the exception says you must now specify a factory class.</p>

<p>To fix the exception add a new line to your active record facility config:</p>

<facility id="activerecord.facility" isweb="true" type="Castle.Facilities.ActiveRecordIntegration.ActiveRecordFacility, Castle.Facilities.ActiveRecordIntegration">
    
<assemblies>

    
<item>Nu.Core</item>

    
</assemblies>

    
<config>

    
<add value="false" key="cache.use_query_cache" />

    
<add value="ReadCommitted" key="connection.isolation" />

    
<add value="false" key="show_sql" />

    
<add value="NHibernate.Dialect.SQLiteDialect" key="dialect" />

    
<add value="NHibernate.Driver.SQLite20Driver" key="connection.driver_class" />

    
<add value="true=1;false=0" key="query.substitutions" />

    
<add value="#{ConnectionString}" key="connection.connection_string" />

    
<add value="NHibernate.Connection.DriverConnectionProvider" key="connection.provider" />

    
** <add value="NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle" key="proxyfactory.factory_class" />
      
** </config>

    
</facility>

<p>Then add a reference in your project to NHibernate.ByteCode.Castle.dll.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/01/09/monorail-custom-rescue-controller-irescuecontroller/">MonoRail custom rescue controller (IRescueController)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-01-09T14:28:01+00:00" pubdate data-updated="true">Jan 9<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h5 id="the-problem">The problem</h5>

<p>I am calling a web service from a controller and the web service throws a WebException with different exception messages, one when the remote server is unavailable and another when the remote server times out. I’d like to show a rescue view based on the exception type <strong>and</strong> message not just it’s type.</p>

<p>The standard Monorail Rescue attribute only takes an exception type so there didn’t seem to be an easy way to solve my problem. I could have a generic rescue view which shows an error for all WebExceptions but I’d like to be a bit more specific. I could send all WebExceptions to the same rescue view and then handle the different messages in the view but I didn’t want the logic in my rescue view. </p>

<p>I noticed in the trunk (revision 5407) the Rescue attribute takes a rescue controller which I’d never seen before. I started digging around the web and source and came up with the following solution which works although I not sure its the best solution!</p>

<h5 id="my-solution">My solution</h5>

<p>I changed my base controller to use a rescue controller instead of rescue views:</p>

<pre><code>[Rescue(typeof(RescueController))]
public class ApplicationController : SmartDispatcherController
</code></pre>

<p>I then created a RescueController:</p>

<pre><code>[Layout("default")]
public class RescueController : SmartDispatcherController, IRescueController
{
	public void Rescue(Exception exception, IController controller, IControllerContext controllerContext)
	{
		SetRescueView("generalerror");
		if (exception.GetType() == typeof(WebException) &amp;&amp; exception.Message == "Unable to connect to the remote server") SetRescueView("webexception_cannot_connect");
		if (exception.GetType() == typeof(WebException) &amp;&amp; exception.Message == "The operation has timed out") SetRescueView("webexception_portal_timeout");

	}

	private void SetRescueView(string viewname)
	{
		RenderSharedView(Path.Combine("rescues", viewname));
	}
}
</code></pre>

<p>The Rescue method simply checks the exception type and message and if it gets a match it sets the relevant rescue view. Notice I’m using a little helper method to set the rescue view this tells Monorail look in the standard folder Views\rescues for the view otherwise it would be looking for these views in Views\Rescue which could get confusing.</p>

<h5 id="gotchas">Gotchas!</h5>

<ul>
  <li>
    <p>Make sure your custom rescue controller inherits from SmartDispatcherController otherwise your custom controller will not get called. See Castle Project Users list for <a href="http://groups.google.co.uk/group/castle-project-users/browse_thread/thread/caab15edb9714ccc/5d8e5a96c309b42e">more detail</a></p>
  </li>
  <li>
    <p>Add the Layout attribute to the Rescue controller if you want to use your standard layout on the rescue pages.</p>
  </li>
  <li>
    <p>If your using the Windsor container remember to add the Rescue controller to your container otherwise your custom rescue controller will not be found and called. This one had me scratching my head for a while!</p>
  </li>
  <li>
    <p>Make sure your rescue views exist in the Views\rescues folder otherwise you will get the standard ASP.NET error page and it will look like none of this has worked.</p>
  </li>
  <li>
    <p>This works with the trunk (revision 5407) not sure when the IRescueController functionality was added so it may not work with earlier revisions.</p>
  </li>
</ul>

<h5 id="a-better-solution">A better solution?</h5>

<p>I thought a better solution would be to add a sub string message to the Rescue attribute which could be used to match the exception type and message. E.g:</p>

<pre><code>Rescue("web_exception_unable_to_connect", typeof(WebException), "Unable to connect to remote server")
Rescue("web_exception_timeout", typeof(WebException), "The operation has timed out")
</code></pre>

<p>I couldn’t see an easy way to extend the standard Monorail rescue functionality so I ended up creating a builder which allowed me to define a map of exceptions to rescue views.</p>

<pre><code>builder.Map&lt;WebException&gt;()
	.WithMessageContaining("Unable to connect to the remote server")
	.OrMessageContaining("The remote server returned an error: (403) Forbidden.")
	.ToRescue("webexception_cannot_connect");

builder.Map&lt;WebException&gt;()
	.WithMessageContaining("The operation has timed out")
	.ToRescue("webexception_portal_timeout");
</code></pre>

<p>My final rescue controller simply uses the map to select the correct rescue view, no more if statements needed.</p>

<pre><code>[Layout("default")]
public class RescueController : SmartDispatcherController, IRescueController
{
	private readonly IExceptionToRescueMapper _mapper;

	public RescueController(IExceptionToRescueMapper mapper)
	{
		_mapper = mapper;
	}

	public void Rescue(Exception exception, IController controller, IControllerContext controllerContext)
	{
		SetRescueView(_mapper.GetRescueFor(exception));
	}

	private void SetRescueView(string viewname)
	{
		RenderSharedView(Path.Combine("rescues", viewname));
	}
}
</code></pre>

<p>If you know of a better way I’d love to hear it…</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/01/03/books-head-first-c-lab-1-solution/">Books + Head First C# + Lab 1 Solution</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-01-03T21:52:00+00:00" pubdate data-updated="true">Jan 3<span>rd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’ve been reading through the new Head First book <a href="http://www.amazon.com/gp/product/0596514824?ie=UTF8&amp;tag=justinramelco-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0596514824">Head First C#</a><img src="http://www.assoc-amazon.com/e/ir?t=justinramelco-20&amp;l=as2&amp;o=1&amp;a=0596514824" alt="" />
which appeared on <a href="http://search.safaribooksonline.com/home">Safari</a> just before Christmas. I’ve been a fan of the Head Fist books ever since reading their best selling <a href="http://www.amazon.com/gp/product/0596007124?ie=UTF8&amp;tag=justinramelco-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0596007124">Head First Design Patterns</a><img src="http://www.assoc-amazon.com/e/ir?t=justinramelco-20&amp;l=as2&amp;o=1&amp;a=0596007124" alt="" /> book. This particular book is aimed at beginners / hobbyists so I’m not exactly the target audience but hey it covers C# 3 so its got to be worth at least a skim.</p>

<p>I was pleased to see they’ve added a new feature to the head first series namely lab sections. There are 3 lab sections in the book which are basically specifications for mini games, the idea being the reader creates the games using their newly acquired C# skills. I though this was a great idea and having a lot of spare time in front of my laptop over the Christmas (due to a very <a href="http://justin.ramel.googlepages.com/ankle.jpg">sore ankle</a>) I did the first of the labs “A day at the races”.</p>

<p>I used the lab as an exercise in <a href="http://behaviour-driven.org/">Behaviour Driven Development (BDD)</a> which I’d recently read about <a href="http://dannorth.net/introducing-bdd">here</a> and <a href="http://codebetter.com/blogs/david_laribee/archive/2007/12/17/approaching-bdd.aspx">here</a>. I also got to try out a Test Data Builder I’d read about <a href="http://nat.truemesh.com/archives/000714.html">here</a>. Now I’m not convinced I hit the nail on the head with the BDD as my solution wasn’t created in a test behaviour first manor. This was mainly due to the fact the book provides you with the shell of a solution to keep things nice and simple for beginners. Never the less it was a good fun doing the lab it’s a great way to try out new techniques.</p>

<p>All in all the BDD experience was pretty good not sure about the code duplication in the context setup but you got to love the way the descriptive contexts and method names combine to read like a sentence:</p>

<p><img src="http://justin.ramel.googlepages.com/bdd.gif" alt="" /></p>

<p>Also the Test Data Builder is a really flexible way to create test data using a fluent interface which again is really easy to read:</p>

<p><code>myGuy = new GuyBuilder().WithName("Joe").AndCash(50).Build(); </code></p>

<p>You can download the solution <a href="http://justin.ramel.googlepages.com/lab01.zip">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/10/10/tortoisesvn-global-ignore-pattern/">TortoiseSVN + Global ignore pattern</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-10-10T14:37:22+01:00" pubdate data-updated="true">Oct 10<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="http://justinram.files.wordpress.com/2007/10/tortoise.GIF" alt="Tortoise" />
<code>build_log.xml *.suo *.user _ReSharper* *.resharper bin obj class build</code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2007/06/18/castle-using-the-trunk-my-config/">Castle + Using the Trunk + My registry entries</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-06-18T18:03:34+01:00" pubdate data-updated="true">Jun 18<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When I build from the trunk I usually follow the instructions found here:</p>

<p><a href="http://using.castleproject.org/display/CASTLE/Using+the+Trunk">http://using.castleproject.org/display/CASTLE/Using+the+Trunk</a></p>

<p>My source location is slightly different from the instructions so I have to hand edit the registry entries listed at the end of the page. So to save me doing that again here they are:</p>

<p><code>Windows Registry Editor Version 5.00 [HKEY_LOCAL_MACHINE\SOFTWARE\Castle] "vs8templatelocation"="C:\\source\\Castle\\Tools\\VSNetWizards\\CastleTemplates\\VS8" [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\v2.0.50727\AssemblyFoldersEx\castle] @="C:\\source\\Castle\\build\\net-2.0\\debug" </code></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/6/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/page/4/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/09/15/vim-to-emacs-ace-jump-mode/">Vim to Emacs - Ace Jump Mode</a>
      </li>
    
      <li class="post">
        <a href="/2013/09/14/vim-to-emacs/">Vim to Emacs</a>
      </li>
    
      <li class="post">
        <a href="/2013/03/22/git-feature-workflow-more-basic-commands/">Git feature workflow - more basic commands</a>
      </li>
    
      <li class="post">
        <a href="/2013/03/15/git-feature-workflow-basic-commands/">Git feature workflow - basic commands</a>
      </li>
    
      <li class="post">
        <a href="/2013/01/15/5-minute-setup/">Jenkins for .net in 5 Minutes</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Strava</h1>
  <br />
  <iframe height='160' width='272' frameborder='0' allowtransparency='true' scrolling='no' src='http://app.strava.com/athletes/1108047/activity-summary/38bbd39fbf5da9f3bf5e3845fb2f4592704e5de4'></iframe>
</section>
<section>
<h1>Twitter</h1>
<a class="twitter-timeline" href="https://twitter.com/justinramel" data-widget-id="379381495074287617">Tweets by @justinramel</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>

<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll&#8230;</ul>
  <p><a href="http://pinboard.in/u:njr11">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "njr11"; //id target for pinboard list
  var pinboard_count = 3; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/108885363809433432894?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Justin Ramel -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'justinramel';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
